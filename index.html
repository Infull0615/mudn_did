<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mudn_did</title>
    <style>
        body{
            overflow: scroll;
            scrollbar-width: none;
            scroll-snap-type: y mandatory;
            height: 100vh;
            width: 100vw;
            object-fit: contain;
            display: grid;
            grid-template-columns: 1fr;
        }
        img video {
            scroll-snap-align: start;
        }
    </style>
</head>
<body>
    로딩중
    <script>
        window.addEventListener("click", (e) => {
            if (!document.fullscreenElement)
                document.documentElement.requestFullscreen();
            else
                document.exitFullscreen();
        });

        let medias = [];
        let count = 0;
        const load_medias = () => {
            while(true){
                let temp_ok = false;
                count += 1;
                fetch(`https://raw.githubusercontent.com/Infull0615/mudn_did/main/media/slide${count}.webp`)
                    .then(
                        (res) => {temp_ok = res.ok}
                    );
                if (temp_ok){
                    medias.push({type: "img", link: `https://raw.githubusercontent.com/Infull0615/mudn_did/main/media/slide${count}.webp`});
                } else {
                    fetch(`https://raw.githubusercontent.com/Infull0615/mudn_did/main/media/slide${count}.mp4`)
                    .then(
                        (res) => {temp_ok = res.ok}
                    );
                }
                if (temp_ok){
                    medias.push({type: "video", link: `https://raw.githubusercontent.com/Infull0615/mudn_did/main/media/slide${count}.mp4`});
                }

                let inner_html = "";
                count = 0;
                medias.forEach((m) => {
                    if (m.type === "img"){
                        inner_html += `<img src=\"${m.link}\" />`;
                    }else{
                        count += 1;
                        inner_html += `<video class=\"video${count}\" muted> <source src=\"${m.link}\" type=\'video/mp4\' /> </video>`;
                    }
                });
            }
        }
        
        let is_video = false;
        let video_index = 0;
        const sliding = (index) => {
            if (medias.length === 0) setTimeout(sliding(0),1000);
            else {
                let body = document.body;
                if (medias[index].type === "video"){
                    video_index += 1;
                    let video = document.querySelector(`.video${video_index}`).get(0);
                    video.pause();
                    video.currentTime = 0;
                    video.play();
                    const v_end = () => {
                        if (video.prop("ended")){
                            body.scrollTop += 100;
                            if (body.offsetHeight + body.scrollTop >= body.scrollHeight){
                                body.scrollTop = 0;
                            }
                            return sliding(index + 1);
                        }else {
                            return setTimeout(v_end(), 200);
                        }
                    }
                    return v_end();
                }
                else {
                    return setTimeout(
                        () => {
                            body.scrollTop += 100;
                            if (body.offsetHeight + body.scrollTop >= body.scrollHeight){
                                body.scrollTop = 0;
                            }
                            return sliding(index + 1);
                        }, 1000
                    );
                }
            }
        }
    </script>
</body>
</html>